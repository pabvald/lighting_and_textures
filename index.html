<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="./estilos/estilo01.css">
  <title> Pr√°ctica 03</title>
  
  <!-- ****************   VERTEX SHADER *******************-->
  <script id="vertex-shader" type="x-shader/x-vertex">

    attribute vec3 a_position;  
    attribute vec3 u_color;

    //Vectors
    attribute vec3 a_normal;
    uniform vec3 light_vector;

    //Ambient light
    uniform bool ambient_light;
    uniform vec3 intensity_ambient;

    //Diffuse light
    uniform bool diffuse_light;
    uniform vec3 intensity_diffuse;

    uniform mat4 rotation;    
    varying highp vec4 vColor;

    void main() {     
      gl_Position = rotation*vec4(a_position, 1.0);      

      vec3 normal = mat3(rotation)*normalize(a_normal);
     

      if(!ambient_light && !diffuse_light){ // No lighting
          vColor = vec4(u_color,1);

      }  else {
        vec3 lit_color = vec3(0,0,0);
        if(ambient_light) {
            vec3 ambient_color = u_color*intensity_ambient;
            lit_color = ambient_color;
        }

        if(diffuse_light) {
            float cosTheta = max(dot(normalize(light_vector),normal),0.0);
            vec3 diffuse_color = cosTheta*u_color*intensity_diffuse;
            float maxXd = max(diffuse_color.x,lit_color.x);
            float maxYd = max(diffuse_color.y,lit_color.y);
            float maxZd = max(diffuse_color.z,lit_color.z);
            lit_color = vec3(maxXd, maxYd, maxZd);
        } 

        vColor = vec4(lit_color,1);
      }          
    }

  </script>

  <!-- ****************   FRAGMENT SHADER *******************-->
  <script id="fragment-shader" type="x-shader/x-fragment">
    varying highp vec4 vColor;
  

    void main() {       

        gl_FragColor = vColor;
    }
  </script>

  <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
  <script type="text/javascript" src="./libGL/dist/gl-matrix-min.js"></script>
  <script type="text/javascript" src="./libGL/dist/gl-matrix.js"></script>

  <!-- **************** FUNCIONES JAVASCRIPT ****************-->
  <script type="text/javascript" src="index.js"></script>

  </head>
  <body id="body" onload="initWebGL()">   
    <h1> Lighting and textures</h1> 
    <div>
      <table>
        <tr>
          <td>
            <div id="lightingcontainer">
              <h4>Lighting components</h4>
              <ul type="none">
                <li><input type="checkbox" name="ambient_light" onchange="onChangeLighting(1)" checked>     Ambient light      </li>
                <li><input type="checkbox" name="diffuse_light" onchange="onChangeLighting(2)">             Diffuse light      </li>
                <li><input type="checkbox" name="specular_light" onchange="onChangeLighting(3)">            Specular light     </li>
              </ul>
            </div>
          </td>
           <td>
            <div id="div-canvas" >
              <canvas id="canvas" width="500" height="500" ></canvas>
            </div>
           </td>
           <td>
             <div >
                 <div id="ambient-light-container">
                    <h4>
                      Light Vector
                    </h4>
                     <div class="slidercontainer"> 
                      <h6> x <h6>
                      <input type="range" class="slider" id="xLightVector" value="1" min="-1" max="1" step="0.1" oninput="onInputSliderXLightVector()"> 
                    </div>
                    <div class="slidercontainer"> 
                      <h6> y <h6>
                      <input type="range" class="slider" id="yLightVector" value="1" min="-1" max="1" step="0.1" oninput="onInputSliderYLightVector()"> 
                    </div>
                    <div class="slidercontainer"> 
                      <h6> z <h6>
                      <input type="range" class="slider" id="zLightVector" value="-1" min="-1" max="1" step="0.1" oninput="onInputSliderZLightVector()"> 
                    </div>
                 </div>
                <div id="ambient-light-container">
                  <h4>
                    Ambient light
                  </h4>
                  <div class="slidercontainer"> 
                    <input type="range" class="slider" id="Ia" value="255" min="0" max="255" oninput="onInputSliderIa()"> 
                  </div>  
                </div>
                 <div id="diffuse-light-container">
                  <h4>
                    Diffuse light
                  </h4>
                  <div class="slidercontainer"> 
                    <input type="range" class="slider" id="Id" value="255" min="0" max="255" oninput="onInputSliderId()" disabled> 
                  </div>  
                </div>
             </div>
          </td>
        </tr>
        
      </table> 
    <div>
  </body>
</html>